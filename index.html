<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S.G.E - Brigada HSM</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/@phosphor-icons/web@2.0.3"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1"></script>

    <script>
        tailwind.config = {
            prefix: 'tw-',
            corePlugins: { preflight: false } // Evita conflito com CSS nativo
        }
    </script>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

    <aside class="sidebar">
        <div class="brand">
            <h2 id="sb_brand" contenteditable="true" onblur="GlobalManager.save(this)">BRIGADA HSM</h2>
            <span id="sb_sub" contenteditable="true" onblur="GlobalManager.save(this)">Hospital Santa Marta</span>
        </div>
        <div class="user-profile">
            <img src="https://ui-avatars.com/api/?name=Medeiros&background=dc2626&color=fff" alt="User" class="avatar">
            <div class="user-info">
                <h4 id="sb_user_name" contenteditable="true" onblur="GlobalManager.save(this)">Medeiros</h4>
                <p id="sb_user_role" contenteditable="true" onblur="GlobalManager.save(this)">Chefe de Brigada</p>
            </div>
        </div>
        <ul class="nav-menu">
            <li class="nav-item active" onclick="GlobalManager.switchView('dashboard', this)">
                <i class="fa-solid fa-table-columns"></i> Dashboard
            </li>
            <li class="nav-item" onclick="GlobalManager.switchView('escala', this)">
                <i class="fa-solid fa-calendar-days"></i> Escala
            </li>
            <li class="nav-item" onclick="GlobalManager.switchView('indicadores', this)">
                <i class="fas fa-chart-pie"></i> Indicadores
            </li>
            <li class="nav-item">
                <i class="fa-solid fa-plane-departure"></i> F√©rias
            </li>
            <li class="nav-item" onclick="GlobalManager.switchView('treinamentos', this)">
                <i class="fas fa-graduation-cap"></i> Treinamentos
            </li>
        </ul>
        <div class="logout"><i class="fa-solid fa-power-off"></i> Sair</div>
    </aside>

    <main class="main-content">
        
        <div id="view-dashboard" class="view-section active">
            <div class="section-dark-header">
                <div class="header-title"><h1><i class="fa-solid fa-grip"></i> Vis√£o Geral</h1></div>
                <div style="display: flex; gap: 15px; align-items: center;">
                    <div class="status-pill">HSM Operante</div>
                    <div id="dashboardDate" style="font-size: 12px; text-align: right;"></div>
                </div>
            </div>
            <div class="top-grid">
                <div class="welcome-card">
                    <h2 contenteditable="true" id="dash_welcome_title" onblur="GlobalManager.save(this)">Ol√°, Chefe Medeiros</h2>
                    <p contenteditable="true" id="dash_welcome_msg" onblur="GlobalManager.save(this)">O sistema est√° sincronizado.</p>
                </div>
                <div class="card relative">
                    <div class="metric-label">Extintores Vencendo</div>
                    <div class="metric-val">3 <span class="warning-text">Setor UTI</span></div>
                    <i class="fa-solid fa-triangle-exclamation icon-corner"></i>
                </div>
            </div>
            <div class="content-grid">
                <div class="card">
                    <h3 class="card-title"><i class="fa-solid fa-clock-rotate-left"></i> Di√°rio de Ocorr√™ncias</h3>
                    <div class="timeline-item">
                        <div class="timeline-icon"><i class="fa-solid fa-check"></i></div>
                        <div>
                            <h5 contenteditable="true" onblur="GlobalManager.save(this)" id="occ_1_t">Vistoria Pedi√°trica</h5>
                            <p contenteditable="true" onblur="GlobalManager.save(this)" id="occ_1_d">Rotas desobstru√≠das.</p>
                        </div>
                    </div>
                </div>
                <div class="card team-card">
                    <h3 class="card-title text-white">Plant√£o Hoje</h3>
                    <span id="shiftLabel" class="text-sm opacity-70"></span>
                    <div id="teamListContainer" class="mt-4 flex flex-col gap-2"></div>
                </div>
            </div>
        </div>

        <div id="view-escala" class="view-section">
            <div class="escala-container">
                <div class="section-dark-header">
                    <div>
                        <h1 contenteditable="true" onblur="GlobalManager.save(this)" id="esc_title">GERENCIADOR DE ESCALA 2026 üî•</h1>
                    </div>
                    <div class="month-control">
                        <button class="nav-arrow" onclick="EscalaApp.changeMonth(-1)">‚ùÆ</button>
                        <div id="displayMonth">JANEIRO 2026</div>
                        <button class="nav-arrow" onclick="EscalaApp.changeMonth(1)">‚ùØ</button>
                    </div>
                    <div class="escala-actions">
                        <button class="btn-reset" onclick="EscalaApp.resetMonth()">‚Ü∫ Reset</button>
                        <button class="btn-print" onclick="window.print()">üñ® Imprimir</button>
                    </div>
                </div>
                <div class="table-paper">
                    <div class="table-scroll">
                        <table id="mainTable"><thead id="tableHead"></thead><tbody id="tableBody"></tbody></table>
                    </div>
                </div>
                <div class="footer-grid">
                    <div class="check-card">
                        <div class="card-title-purple">Checklist Individual</div>
                        <div id="listCheck1" style="flex:1;"></div>
                    </div>
                    <div class="check-card">
                        <div class="card-title-purple">Escala de Extintores</div>
                        <div id="listCheck2" style="flex:1;"></div>
                    </div>
                    <div class="check-card">
                        <div class="card-title-purple">Obstru√ß√£o</div>
                        <div id="listCheck3" style="flex:1;"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-indicadores" class="view-section">
            <div class="section-dark-header">
                <div><h1><i class="ph-fill ph-chart-bar"></i> KPI & Indicadores</h1></div>
                <div class="tw-flex tw-gap-2">
                    <button onclick="IndicadoresApp.filterByYear('2025')" id="btn-year-2025" class="slicer-btn slicer-active">2025</button>
                    <button onclick="IndicadoresApp.filterByYear('2026')" id="btn-year-2026" class="slicer-btn">2026</button>
                </div>
            </div>
            <div class="tw-flex tw-gap-6 tw-border-b tw-border-slate-200 tw-mb-6">
                <button onclick="IndicadoresApp.switchTab('overview')" id="tab-btn-overview" class="tab-btn-dash active"><i class="ph ph-chart-line-up"></i> Vis√£o Executiva</button>
                <button onclick="IndicadoresApp.switchTab('conformidade')" id="tab-btn-conformidade" class="tab-btn-dash"><i class="ph ph-shield-check"></i> Conformidade</button>
                <button onclick="IndicadoresApp.switchTab('evacuacao')" id="tab-btn-evacuacao" class="tab-btn-dash"><i class="ph ph-users-three"></i> Evacua√ß√£o</button>
            </div>
            <div class="tw-bg-white tw-p-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-mb-6 tw-flex tw-items-center tw-gap-3 tw-overflow-x-auto">
                <span class="tw-text-xs tw-font-bold tw-text-slate-400 tw-uppercase">M√™s:</span>
                <div id="month-slicer" class="tw-flex tw-gap-1"></div>
            </div>
            <div id="indicadores-content" class="tw-min-h-[500px]"></div>
        </div>

        <div id="view-treinamentos" class="view-section">
            <div class="section-dark-header">
                <div><h1>PLANO DE ENSINO 2026</h1></div>
                <div class="training-filters">
                    <button class="slicer-btn slicer-active" onclick="TreinamentosApp.filter('todos', this)">Todos</button>
                    <button class="slicer-btn" onclick="TreinamentosApp.filter('Lideran√ßa', this)">Chefia</button>
                    <button class="slicer-btn" onclick="TreinamentosApp.filter('T√©cnico', this)">Operacional</button>
                </div>
            </div>
            <div class="tw-grid tw-grid-cols-1 md:tw-grid-cols-3 tw-gap-6 tw-mb-6">
                <div class="tw-bg-slate-800 tw-text-white tw-p-4 tw-rounded-xl">
                    <div class="tw-flex tw-justify-between tw-mb-2">
                        <span class="tw-text-xs tw-font-bold tw-uppercase">Progresso</span>
                        <span id="prog-percent" class="tw-font-bold">0%</span>
                    </div>
                    <div class="progress-bar-container" style="background:rgba(255,255,255,0.1);">
                        <div class="progress-bar-fill" id="fill" style="background:#ef4444; width:0%"></div>
                    </div>
                </div>
            </div>
            <div id="training-grid-container" class="tw-flex tw-flex-col tw-gap-4"></div>
        </div>

    </main>

    <script src="assets/js/database.js"></script>
    <script src="assets/js/global.js"></script>
    <script src="assets/js/escala.js"></script>
    <script src="assets/js/treinamentos.js"></script>
    <script src="assets/js/indicadores.js"></script>
    
    <script>
        // Inicializa√ß√£o Global
        window.onload = () => {
            GlobalManager.init();
            EscalaApp.init(); // Carrega dados para a escala e o dashboard inicial
        };
    </script>
</body>
</html>
